<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin</title>
    <link rel="icon" type="image/x-icon" href="../assets/brand/logos/logo-icon.svg">
    <link rel="stylesheet" href="../assets/brand/icons/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,400;0,600;0,700;0,800;1,400;1,600;1,700;1,800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/admin.css">
</head>
<body>
    <!-- MAIN BODY HERE -->
    <div id="main-body" class="section">
        <!-- SIGN IN -->
        <div id="login-page" class="section__container admin">
            <div class="row">
                <div class="login__container col-4">
                    <div class="login__header">
                        <h4 class="login__title">Đăng nhập</h4>
                    </div>
                    <div class="login__form--item">
                        <div class="subtitle2">Tên đăng nhập</div>
                        <input type="email" id ="login-email" class="product-textField js-checking">
                    </div>
                    <ul class="input-requirements for-signin__email"></ul>
                    <div class="login__form--item">
                        <div class="subtitle2">Mật khẩu</div>
                        <input type="password" id ="login-password" class="product-textField js-checking">
                    </div>
                    <ul class="input-requirements for-signin__password"></ul>
                    <input type="submit" value="Đăng nhập" class="login__form--item login__sigin--btn size-l">
                </div>
            </div>
        </div>
        <!-- SIGN IN -->
    </div>
    <!-- MAIN BODY HERE -->

    <!-- FOOTER -->
    <div id="footer" class="section">
        <div class="section__container">
            <div class="footer__about-brand">
                <img src="../assets/brand/logos/logo-full.svg" alt="" class="logo" id="footer-logo">
                <p class="intro body2">Bagsto cung cấp các sản phẩm balo, ví, túi xách nam nữ. Chúng tôi cam kết mang đến cho bạn những sản phẩm chất lượng cao, thiết kế sang trọng, lịch lãm, phù hợp với mọi nhu cầu.</p>
                <div class="socials">
                    <a href="#" class="socials__item"><i class="icon-facebbook"></i></a>
                    <a href="#" class="socials__item"><i class="icon-instagram"></i></a>
                    <a href="#" class="socials__item"><i class="icon-linkedin"></i></a>
                    <a href="#" class="socials__item"><i class="icon-twitter"></i></a>
                </div>
            </div>
            <ul class="footer__nav">
                <li class="nav__title overline">Chính sách</li>
                <li class="nav__item body2"><a href="#">Chính sách bảo mật</a></li>
                <li class="nav__item body2"><a href="#">Chính sách bảo hành</a></li>
                <li class="nav__item body2"><a href="#">Chính sách đổi trả</a></li>
                <li class="nav__item body2"><a href="#">Chính sách khách hàng thân thiết</a></li>
                <li class="nav__item body2"><a href="#">Chính sách vận chuyển</a></li>         
            </ul>
            <ul class="footer__nav">
                <li class="nav__title overline">Liên hệ</li>
                <li class="nav__item body2"><a href="mailto:cskh@bagsto.vn">cskh@bagsto.vn</a></li>
                <li class="nav__item body2"><a href="tel:+84 9797 9797">+84 9797 9797</a></li>
                <li class="nav__item body2"><a href="#">273 An Dương Vương, Quận 5, Tp.HCM</a></li>
            </ul>
        </div>
        <div class="section__container"><p class="copyright body2">Bagsto © 2021. All rights reserved</p></div>
    </div>
    <!-- FOOTER -->
    
</body>
</html>

<script>
    // VALIDATION
    //----------------------------------------------------------------
    function CustomValidation() {
        this.invalidities = [];
        this.validityChecks = [];
    }
    CustomValidation.prototype = {
        addInvalidity: function(message) {
            this.invalidities.push(message);
        },
        getInvalidities: function() {
            return this.invalidities.join('. \n');
        },
        checkValidity: function(input) {
            for ( var i = 0; i < this.validityChecks.length; i++ ) {
        var requirementElement = this.validityChecks[i].element;
                var isInvalid = this.validityChecks[i].isInvalid(input);
        var messages = this.validityChecks[i].invalidityMessage;
                if (isInvalid) {
                    this.addInvalidity(messages);
                }
                if (requirementElement) {
                    if (isInvalid) {
                        requirementElement.classList.add('invalid');
                inner_ul = ``;
                for(var j = 0; j < this.invalidities.length; j++) {
                    inner_ul += `<li>${this.invalidities[j]}</li>`;
                }
                requirementElement.innerHTML = inner_ul;
                    } else {
                        requirementElement.classList.remove('invalid');
                    }
                } 
            }
        }
    };

    function checkInput(input) {
        input.CustomValidation.invalidities = [];
        input.CustomValidation.checkValidity(input);
    }
    //----------------------------------------------------------------
    // VALIDATION
    // Check Validation
    var signinEmailValidityChecks = [
        {
            isInvalid: function(input) {
                return !emailFormat.test(input.value);
            },
            invalidityMessage: 'Định dạng email không đúng',
            element: document.querySelector('.input-requirements.for-signin__email')
        }
    ];
    var signinEmailInput = document.getElementById('login-email');
    signinEmailInput.CustomValidation = new CustomValidation();
    signinEmailInput.CustomValidation.validityChecks = signinEmailValidityChecks;

    var signinPasswordValidityChecks = [
        {
            isInvalid: function(input) {
                return input.value.length < 8 | input.value.length > 100;
            },
            invalidityMessage: 'Mật khẩu phải có ít nhất 8 ký tự',
            element: document.querySelector('.input-requirements.for-signin__password')
        },
        {
            isInvalid: function(input) {
                return !numberFormat.test(input.value);
            },
            invalidityMessage: 'Mật khẩu phải bao gồm ký tự và số',
            element: document.querySelector('.input-requirements.for-signin__password')
        },
        {
            isInvalid: function(input) {
                return !lowercaseFormat.test(input.value);
            },
            invalidityMessage: 'Mật khẩu phải bao gồm ký tự in thường',
            element: document.querySelector('.input-requirements.for-signin__password')
        },
        {
            isInvalid: function(input) {
                return !uppercaseFormat.test(input.value);
            },
            invalidityMessage: 'Mật khẩu phải bao gồm ký tự in hoa',
            element: document.querySelector('.input-requirements.for-signin__password')
        },
        {
            isInvalid: function(input) {
                return !specialCharFormat.test(input.value);
            },
            invalidityMessage: 'Mật khẩu phải chứa ký tự đặc biệt',
            element: document.querySelector('.input-requirements.for-signin__password')
        }
    ];
    var signinPasswordInput = document.getElementById('login-password');
    signinPasswordInput.CustomValidation = new CustomValidation();
    signinPasswordInput.CustomValidation.validityChecks = signinPasswordValidityChecks;

    var signinInputs = document.querySelectorAll('#login-page input:not([type="submit"]).js-checking');
    var signinSubmit = document.querySelector('#login-page input[type="submit"]');
    for (var i = 0; i < signinInputs.length; i++) {
        signinInputs[i].addEventListener('keyup', function() {
            checkInput(this);
        });
    }
    signinSubmit.addEventListener('click', function() {
        for (var i = 0; i < signinInputs.length; i++) {
            checkInput(signinInputs[i]);
        }
    });
    // Check Validation


    // Check exist and login
    let userLogin = JSON.parse(localStorage.getItem("currentAdminUser"));
    if(userLogin){ 
        window.location.href = ".\\admin.html";
    }
    signinSubmit.addEventListener("click", () => {
        const u = usersList.find((user) => ((user.email == signinEmailInput.value && user.password == signinPasswordInput.value && user.role == "admin") ? user : null));
        if (u) {
            localStorage.setItem("currentAdminUser",JSON.stringify(u));
            window.location.href = ".\\admin.html";
        }
        else {
            alert("Không có tài khoản")
        }
    });
    // Check exist and login
</script>
<script src="../assets/scripts/business.js"></script>